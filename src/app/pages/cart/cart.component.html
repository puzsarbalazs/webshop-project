<p-toast position="bottom-center" [hideTransitionOptions]="'0ms ease-in'"></p-toast>
<app-successfull-purchase></app-successfull-purchase>
<app-toast-message></app-toast-message>

<div *ngIf="!cart.items.length" class="max-w-7xl mx-auto">
  <p-card>
    <span>
      Your cart is empty.
    </span>
    <span>
      <button pButton class="p-button-outlined -mb-2 p-button-secondary" routerLink="/home">
        Start shopping <i class="pi pi-directions-alt" style="margin-left:10px"></i>
      </button>
    </span>
  </p-card>
</div>

<div *ngIf="cart.items.length" class="max-w-7xl mx-auto">
  <p-card >
    <p-table [value]="dataSource" >
      <ng-template pTemplate="header">
        <tr>
          <th *ngFor="let col of displayedColumns">
            {{col}}
          </th>
          <th>
            <button pButton (click)="onClearCart()" class="p-button-danger p-button-raised">
              Clear all<i class="pi pi-trash" style="font-size: 1.5rem; margin-left: 10px;"></i>
            </button>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>
            <img src="{{ product.product }}" alt="product" class="w-[100px] my-5" />
          </td>
          <td class="truncate max-w-xs ">
            {{product.name}}
          </td>
          <td>
            {{product.price | currency}}
          </td>
          <td>
            <button (click)="onRemoveQuantity(product)"><i class="pi pi-minus mx-1"></i></button>
            {{product.quantity}}
            <button (click)="onAddQuantity(product)"><i class="pi pi-plus mx-1"></i></button>
          </td>
          <td>
            {{product.quantity*product.price | currency}}
          </td>
          <td>
            <button (click)="onRemoveFromCart(product)" pButton class="p-button-danger p-button-text">
              <i class="pi pi-times-circle" style="font-size: 2.5rem"></i>
            </button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <tr>
          <td class="py-5">
            <span>
              <button pButton class="p-button-outlined -mb-2 p-button-secondary" routerLink="/home">
                Continue shopping <i class="pi pi-directions-alt" style="margin-left:10px"></i>
              </button>
            </span>
          </td>
          <td>{{cart.items.length}} products</td>
          <td></td>
          <td>{{getTotalQuantity(cart.items)}} overall quantity</td>
          <td>
            <span class="text-lg">{{getTotal(cart) | currency}}</span>
          </td>
          <td><button pButton class="p-button-success p-button-rounded" (click)="proceedToCheckOut(cart)"><i class="pi pi-dollar" style="font-size: 2rem"></i></button></td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
  <div *ngIf="cart.items.length" class="max-w-7xl mx-auto">
    <h1 class="text-4xl my-4 text-cyan-50 font-bold">Recommended Items</h1>
    <div class="p-grid">
    <ng-container *ngFor="let produc of recommendedProducts | async; let i=index">
      <p-card *ngIf="i===0" class="mb-4 p-grid">
        <div class="p-grid p-col-12">
          <div class="p-col-3">
            <img [src]="produc.image">
          </div>
          <div class="p-col-9 p-grid">
            <div class="p-col-12 text-3xl">{{produc.title}}</div>
            <div class="p-col-12">{{produc.description}}</div>
            <div class="p-grid mt-8">
              <span class="mt-2 pl-4">{{produc.price | currency}}</span>
              <button pButton class="ml-9" [ngStyle]="{height: '40px'}" (click)="addToCart(produc)"><i class="pi pi-shopping-cart"></i></button>
            </div>
          </div>
        </div>
      </p-card>
      <p-card *ngIf="i!==0" class="p-grid p-col-6 ml-1">
        <div class="p-grid p-col-12">
          <div class="p-col-3">
            <img [src]="produc.image">
          </div>
          <div class="p-col-9 p-grid">
            <div class="p-col-12 text-3xl">{{produc.title}}</div>
            <div class="p-col-12">{{produc.description}}</div>
            <div class="p-grid mt-8">
              <span class="mt-1">{{produc.price | currency}}</span>
              <button pButton class="ml-9" (click)="addToCart(produc)"><i class="pi pi-shopping-cart"></i></button>
            </div>
          </div>
        </div>
      </p-card>
    </ng-container>
    </div>
  </div>
</div>
