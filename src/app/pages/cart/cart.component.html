<p-toast position="bottom-center" [hideTransitionOptions]="'0ms ease-in'"></p-toast>
<p-toast position="top-center" key="c" class="confirm-toast" [baseZIndex]="5000" (onClose)="onCancelClearCart()" [hideTransitionOptions]="'0ms ease-in'">
  <ng-template let-message pTemplate="message">
    <div class="p-flex p-flex-column flex flex-col" style="flex: 1">
      <div class="p-text-center text-center">
        <i class="pi pi-exclamation-triangle" style="font-size: 3rem"></i>
        <h4 class="text-lg font-bold my-4">{{message.summary}}</h4>
        <p class="my-2">{{message.detail}}</p>
      </div>
      <div class="p-grid p-fluid flex">
        <div class="p-col-6">
          <button type="button" pButton  label="Yes" class="p-button-success" (click)="onConfirmClearCart()"></button>
        </div>
        <div class="p-col-6">
          <button type="button" pButton label="No" class="p-button-secondary" (click)="onCancelClearCart()"></button>
        </div>
      </div>
    </div>
  </ng-template>
</p-toast>

<div *ngIf="!cart.items.length" class="max-w-7xl mx-auto">
  <p-card>
    <span>
      Your cart is empty.
    </span>
    <span>
      <button pButton class="p-button-outlined -mb-2 p-button-secondary" routerLink="/home">
        Start shopping <i class="pi pi-directions-alt" style="margin-left:10px"></i>
      </button>
    </span>
  </p-card>
</div>

<div *ngIf="cart.items.length" class="max-w-7xl mx-auto">
  <p-card >
    <p-table [value]="dataSource" >
      <ng-template pTemplate="header">
        <tr>
          <th *ngFor="let col of displayedColumns">
            {{col}}
          </th>
          <th>
            <button pButton (click)="onClearCart()" class="p-button-danger p-button-raised">
              Clear all<i class="pi pi-trash" style="font-size: 1.5rem; margin-left: 10px;"></i>
            </button>
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>
            <img src="{{ product.product }}" alt="product" class="w-[100px] my-5" />
          </td>
          <td class="truncate max-w-xs ">
            {{product.name}}
          </td>
          <td>
            {{product.price | currency}}
          </td>
          <td>
            <button (click)="onRemoveQuantity(product)"><i class="pi pi-minus mx-1"></i></button>
            {{product.quantity}}
            <button (click)="onAddQuantity(product)"><i class="pi pi-plus mx-1"></i></button>
          </td>
          <td>
            {{product.quantity*product.price | currency}}
          </td>
          <td>
            <button (click)="onRemoveFromCart(product)" pButton class="p-button-danger p-button-text">
              <i class="pi pi-times-circle" style="font-size: 2.5rem"></i>
            </button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <tr>
          <td class="py-5">
            <span>
              <button pButton class="p-button-outlined -mb-2 p-button-secondary" routerLink="/home">
                Continue shopping <i class="pi pi-directions-alt" style="margin-left:10px"></i>
              </button>
            </span>
          </td>
          <td>{{cart.items.length}} products</td>
          <td></td>
          <td>{{getTotalQuantity(cart.items)}} overall quantity</td>
          <td>
            <span class="text-lg">{{getTotal(cart) | currency}}</span>
          </td>
          <td><button pButton class="p-button-success p-button-rounded"><i class="pi pi-dollar" style="font-size: 2rem"></i></button></td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
